# Requirements: Uom

Total Requirements: 59

| Package Namespace | Requirements Type | Code | Requirement Statements | Files/Folders | Status | Notes on Status | Date Last Updated |
|-------------------|-------------------|------|------------------------|---------------|--------|-----------------|-------------------|
| `Nexus\Uom` | Architechtural Requirement | ARC-UOM-0027 | All data structures defined via Value Objects and interfaces | packages/Uom/src/ValueObjects/Quantity.php; packages/Uom/src/ValueObjects/Dimension.php; packages/Uom/src/ValueObjects/Unit.php; packages/Uom/src/Contracts/UnitInterface.php; packages/Uom/src/Contracts/DimensionInterface.php |  |  |  |
| `Nexus\Uom` | Architechtural Requirement | ARC-UOM-0028 | Business logic MUST be in service layer (UomConversionEngine, UomValidationService) | packages/Uom/src/Services/UomConversionEngine.php; packages/Uom/src/Services/UomValidationService.php; packages/Uom/src/Services/UomManager.php |  |  |  |
| `Nexus\Uom` | Architechtural Requirement | ARC-UOM-0029 | All database migrations in application layer (apps/consuming application) | consuming application (e.g., Laravel app)database/migrations/2025_11_17_200000_create_uom_tables.php |  |  |  |
| `Nexus\Uom` | Architechtural Requirement | ARC-UOM-0030 | All Eloquent models in application layer | consuming application (e.g., Laravel app)app/Models/Unit.php; consuming application (e.g., Laravel app)app/Models/Dimension.php; consuming application (e.g., Laravel app)app/Models/UnitConversion.php; consuming application (e.g., Laravel app)app/Models/UnitSystem.php |  |  |  |
| `Nexus\Uom` | Architechtural Requirement | ARC-UOM-0031 | Repository implementations in application layer | consuming application (e.g., Laravel app)app/Repositories/DbUomRepository.php |  |  |  |
| `Nexus\Uom` | Architechtural Requirement | ARC-UOM-0032 | IoC container bindings in application service provider | consuming application (e.g., Laravel app)app/Providers/UomServiceProvider.php::register() |  |  |  |
| `Nexus\Uom` | Architechtural Requirement | FR-UOM-A01 | Package MUST be framework-agnostic with no Laravel dependencies (NO Facades, Eloquent, Request) | packages/Uom/composer.json; packages/Uom/src/Contracts/; packages/Uom/src/Services/; packages/Uom/src/ValueObjects/ |  |  |  |
| `Nexus\Uom` | Architechtural Requirement | FR-UOM-A02 | All persistence operations (CRUD for Units, Dimensions, Conversions) MUST be defined by UomRepositoryInterface | packages/Uom/src/Contracts/UomRepositoryInterface.php::findUnitByCode(), saveUnit(), findConversion(); consuming application (e.g., Laravel app)app/Repositories/DbUomRepository.php |  |  |  |
| `Nexus\Uom` | Architechtural Requirement | FR-UOM-A03 | Provide descriptive domain-specific exceptions (IncompatibleUnitException, InvalidConversionRatioException) | packages/Uom/src/Exceptions/IncompatibleUnitException.php; packages/Uom/src/Exceptions/InvalidConversionRatioException.php; packages/Uom/src/Exceptions/UnitNotFoundException.php; packages/Uom/src/Exceptions/CircularConversionException.php |  |  |  |
| `Nexus\Uom` | Architechtural Requirement | FR-UOM-A04 | External libraries allowed if framework-agnostic and adhere to monorepo principles | packages/Uom/composer.json (only php ^8.2) |  |  |  |
| `Nexus\Uom` | Business Requirements | BUS-UOM-101 | Quantity Value Object MUST be immutable once created to prevent accidental modification | packages/Uom/src/ValueObjects/Quantity.php (readonly class declaration) |  |  |  |
| `Nexus\Uom` | Business Requirements | BUS-UOM-102 | Direct conversions between units MUST validate that units share the same Dimension before attempting conversion | packages/Uom/src/Services/UomValidationService.php::validateSameDimension(); packages/Uom/src/Services/UomConversionEngine.php::convert() |  |  |  |
| `Nexus\Uom` | Business Requirements | BUS-UOM-103 | Invalid conversion attempts MUST throw IncompatibleUnitException with clear error message | packages/Uom/src/Exceptions/IncompatibleUnitException.php::forUnits(), forDimensions() |  |  |  |
| `Nexus\Uom` | Business Requirements | BUS-UOM-104 | Conversion ratios MUST be positive non-zero values to prevent invalid calculations | packages/Uom/src/Services/UomValidationService.php::validateRatio(); packages/Uom/src/Exceptions/InvalidConversionRatioException.php |  |  |  |
| `Nexus\Uom` | Business Requirements | BUS-UOM-105 | Each UoM MUST be assigned to exactly one Dimension for proper categorization | packages/Uom/src/ValueObjects/Unit.php::getDimension(); consuming application (e.g., Laravel app)database/migrations/2025_11_17_200000_create_uom_tables.php (dimension_code NOT NULL) |  |  |  |
| `Nexus\Uom` | Business Requirements | BUS-UOM-106 | Base Unit for a Dimension CANNOT be changed once units are defined to prevent broken conversions | packages/Uom/src/Services/UomValidationService.php::validateBaseUnitImmutable() |  |  |  |
| `Nexus\Uom` | Business Requirements | BUS-UOM-201 | Conversion graph MUST prevent circular conversion paths that could cause infinite loops | packages/Uom/src/Services/UomConversionEngine.php::detectCircularPath(); packages/Uom/src/Exceptions/CircularConversionException.php |  |  |  |
| `Nexus\Uom` | Business Requirements | BUS-UOM-202 | All conversions within a Dimension MUST route through the Dimension's Base Unit as intermediary | packages/Uom/src/Services/UomConversionEngine.php::convertViaBaseUnit() |  |  |  |
| `Nexus\Uom` | Business Requirements | BUS-UOM-203 | Offset conversions MUST only be allowed for Temperature dimension to prevent misuse | packages/Uom/src/Services/UomValidationService.php::validateOffsetAllowed(); packages/Uom/src/Exceptions/InvalidOffsetConversionException.php |  |  |  |
| `Nexus\Uom` | Business Requirements | BUS-UOM-204 | Unit codes MUST be unique across the entire system to prevent ambiguity | packages/Uom/src/Contracts/UomRepositoryInterface.php::ensureUniqueCode(); consuming application (e.g., Laravel app)database/migrations/2025_11_17_200000_create_uom_tables.php (UNIQUE constraint on code) |  |  |  |
| `Nexus\Uom` | Business Requirements | BUS-UOM-301 | Packaging relationships MUST form a directed acyclic graph (no circular packaging) | packages/Uom/src/Services/UomValidationService.php::validatePackagingDAG() |  |  |  |
| `Nexus\Uom` | Business Requirements | BUS-UOM-302 | Fractional packaging ratios MUST be positive to ensure valid conversions | packages/Uom/src/Services/UomValidationService.php::validatePositiveRatio() |  |  |  |
| `Nexus\Uom` | Functional Requirement | FR-UOM-101 | Provide immutable Quantity Value Object that encapsulates numeric value and base UoM (primary API entry point) | packages/Uom/src/ValueObjects/Quantity.php (readonly class with value and unitCode properties) |  |  |  |
| `Nexus\Uom` | Functional Requirement | FR-UOM-102 | Support simple multiplication/division conversions using only a defined ratio without complex dimension definitions | packages/Uom/src/Services/UomConversionEngine.php::convert(); packages/Uom/src/ValueObjects/ConversionRule.php |  |  |  |
| `Nexus\Uom` | Functional Requirement | FR-UOM-103 | Implement service method to check if two Quantity objects are convertible before attempting operation | packages/Uom/src/Services/UomValidationService.php::areConvertible() |  |  |  |
| `Nexus\Uom` | Functional Requirement | FR-UOM-104 | Support standard arithmetic operations (add, subtract, multiply, divide) of Quantity objects with automatic conversion | packages/Uom/src/ValueObjects/Quantity.php::add(), subtract(), multiply(), divide() |  |  |  |
| `Nexus\Uom` | Functional Requirement | FR-UOM-105 | Provide formatting method to display quantity based on user/system locale settings (decimal, thousand separators) | packages/Uom/src/ValueObjects/Quantity.php::format($locale, $decimals) |  |  |  |
| `Nexus\Uom` | Functional Requirement | FR-UOM-201 | Support definition of Dimensions (Mass, Length, Time) to group and validate units | packages/Uom/src/ValueObjects/Dimension.php; packages/Uom/src/Contracts/DimensionInterface.php; consuming application (e.g., Laravel app)app/Models/Dimension.php |  |  |  |
| `Nexus\Uom` | Functional Requirement | FR-UOM-202 | Implement conversion graph engine to find shortest path between any two convertible units using Dimension validation | packages/Uom/src/Services/UomConversionEngine.php::findConversionPath() |  |  |  |
| `Nexus\Uom` | Functional Requirement | FR-UOM-203 | Support grouping of units into Systems (Metric, Imperial) for reporting and regional consistency | packages/Uom/src/ValueObjects/UnitSystem.php; consuming application (e.g., Laravel app)app/Models/UnitSystem.php; consuming application (e.g., Laravel app)config/uom.php (seed_systems) |  |  |  |
| `Nexus\Uom` | Functional Requirement | FR-UOM-204 | Each Dimension MUST define a single Base Unit (e.g., meter for Length) as intermediary for conversions | packages/Uom/src/ValueObjects/Dimension.php::getBaseUnit(); consuming application (e.g., Laravel app)database/migrations/2025_11_17_200000_create_uom_tables.php (base_unit_code column) |  |  |  |
| `Nexus\Uom` | Functional Requirement | FR-UOM-205 | Support complex conversions involving offset (e.g., Celsius to Fahrenheit: F = C × 1.8 + 32) | packages/Uom/src/Services/UomConversionEngine.php::convertWithOffset(); packages/Uom/src/ValueObjects/ConversionRule.php (offset property) |  |  |  |
| `Nexus\Uom` | Functional Requirement | FR-UOM-301 | Support packaging hierarchies (1 Pallet → 10 Cases → 100 Eaches) with fractional relationships | packages/Uom/src/Services/UomConversionEngine.php::convertPackaging() |  |  |  |
| `Nexus\Uom` | Functional Requirement | FR-UOM-302 | Provide service to convert quantity of packages to base unit equivalent (5 Cases of 100 Eaches → 500 Eaches) | packages/Uom/src/Services/UomConversionEngine.php::packagingToBase() |  |  |  |
| `Nexus\Uom` | Functional Requirement | FR-UOM-303 | Quantity Value Object MUST be easily serializable to JSON/array formats for storage and inter-package communication | packages/Uom/src/ValueObjects/Quantity.php::toArray(), toJson(), fromArray(), fromJson(), jsonSerialize() |  |  |  |
| `Nexus\Uom` | Functional Requirement | FUN-UOM-0306 | 58 total requirements documented (15 FR + 13 DM + 5 PR + 5 SR + 10 BR + 10 ARCH) |  |  |  |  |
| `Nexus\Uom` | Performance Requirement | PER-UOM-101 | Simple direct conversion (A to B with defined ratio) MUST complete in < 5ms | packages/Uom/src/Services/UomConversionEngine.php::convert() with cache |  |  |  |
| `Nexus\Uom` | Performance Requirement | PER-UOM-102 | Complex multi-hop conversion (up to 5 conversions) MUST complete in < 20ms | packages/Uom/src/Services/UomConversionEngine.php::findConversionPath() using BFS |  |  |  |
| `Nexus\Uom` | Performance Requirement | PER-UOM-103 | Quantity arithmetic operations (add, subtract) MUST complete in < 10ms including conversion | packages/Uom/src/ValueObjects/Quantity.php::add(), subtract() |  |  |  |
| `Nexus\Uom` | Performance Requirement | PER-UOM-104 | Conversion path calculation SHOULD cache results for repeated conversions | packages/Uom/src/Services/UomConversionEngine.php ($conversionCache property); consuming application (e.g., Laravel app)config/uom.php (cache_conversions) |  |  |  |
| `Nexus\Uom` | Performance Requirement | PER-UOM-105 | System MUST support at least 1,000 defined units without performance degradation | consuming application (e.g., Laravel app)database/migrations/2025_11_17_200000_create_uom_tables.php (indexed columns); consuming application (e.g., Laravel app)app/Repositories/DbUomRepository.php |  |  |  |
| `Nexus\Uom` | Reliability Requirement | REL-UOM-101 | Conversion calculations MUST use arbitrary precision math to prevent rounding errors | consuming application (e.g., Laravel app)database/migrations/2025_11_17_200000_create_uom_tables.php (DECIMAL(30,15) for ratio/offset) |  |  |  |
| `Nexus\Uom` | Reliability Requirement | REL-UOM-102 | Division by zero in conversions MUST throw InvalidConversionRatioException | packages/Uom/src/Exceptions/InvalidConversionRatioException.php::divisionByZero(); packages/Uom/src/Services/UomValidationService.php::validateRatio() |  |  |  |
| `Nexus\Uom` | Reliability Requirement | REL-UOM-103 | Invalid arithmetic operations on incompatible units MUST fail fast with clear error message | packages/Uom/src/ValueObjects/Quantity.php::add() calls convertTo() which validates; packages/Uom/src/Exceptions/IncompatibleUnitException.php |  |  |  |
| `Nexus\Uom` | Reliability Requirement | REL-UOM-104 | Conversion graph pathfinding MUST handle disconnected graphs gracefully | packages/Uom/src/Services/UomConversionEngine.php::findConversionPath(); packages/Uom/src/Exceptions/ConversionPathNotFoundException.php |  |  |  |
| `Nexus\Uom` | Security and Compliance Requirement | SEC-UOM-101 | Unit definitions MUST enforce tenant isolation if multi-tenancy is enabled | consuming application (e.g., Laravel app)app/Models/Unit.php (optional tenant scoping); consuming application (e.g., Laravel app)config/uom.php (tenant_isolation flag) |  |  |  |
| `Nexus\Uom` | Security and Compliance Requirement | SEC-UOM-102 | Custom unit creation MUST be audited with creator and timestamp | consuming application (e.g., Laravel app)app/Models/Unit.php (timestamps); consuming application (e.g., Laravel app)config/uom.php (audit_logging flag) |  |  |  |
| `Nexus\Uom` | Security and Compliance Requirement | SEC-UOM-103 | Conversion ratio modifications MUST be versioned to maintain audit trail | consuming application (e.g., Laravel app)app/Models/UnitConversion.php ($fillable['version']); consuming application (e.g., Laravel app)database/migrations/2025_11_17_200000_create_uom_tables.php (version column) |  |  |  |
| `Nexus\Uom` | Security and Compliance Requirement | SEC-UOM-104 | System units (predefined) CANNOT be deleted or modified to ensure data integrity | packages/Uom/src/Services/UomValidationService.php::validateNotSystemUnit(); packages/Uom/src/Exceptions/SystemUnitProtectedException.php |  |  |  |
| `Nexus\Uom` | User Story | USE-UOM-101 | As a developer, I want to create a Quantity object with value and unit for simple inventory tracking | $qty = new Quantity(100, 'kg');  |  |  |  |
| `Nexus\Uom` | User Story | USE-UOM-102 | As a developer, I want to add two quantities with automatic unit conversion | $total = $qty1->add($qty2);  |  |  |  |
| `Nexus\Uom` | User Story | USE-UOM-103 | As a developer, I want to check if two quantities are compatible before calculation | if ($validator->areConvertible($qty1, $qty2)) { ... } |  |  |  |
| `Nexus\Uom` | User Story | USE-UOM-104 | As a warehouse manager, I want to convert package units to base units (5 boxes → 500 pieces) | $pieces = $conversionEngine->packagingToBase($qty);  |  |  |  |
| `Nexus\Uom` | User Story | USE-UOM-105 | As a production planner, I want to define BOM quantities in different units (kg, lbs, tons) | $component = new BomComponent($qty, $material);  |  |  |  |
| `Nexus\Uom` | User Story | USE-UOM-106 | As a system admin, I want to define custom dimensions for industry-specific measurements | $dimension = new Dimension('Viscosity', $baseUnit, $system);  |  |  |  |
| `Nexus\Uom` | User Story | USE-UOM-107 | As a developer, I want to format quantities for display with locale-specific formatting | echo $qty->format('en_US'); // "1,234.56 kg" |  |  |  |
| `Nexus\Uom` | User Story | USE-UOM-108 | As an inventory clerk, I want to record stock in different packaging levels (pallets, cases, eaches) | $stock = new Quantity(5, 'pallets')->convertTo('eaches');  |  |  |  |
| `Nexus\Uom` | User Story | USE-UOM-109 | As a developer, I want to serialize quantities to JSON for API responses | return $qty->toJson(); // {"value": 100, "unit": "kg"} |  |  |  |
| `Nexus\Uom` | User Story | USE-UOM-110 | As a procurement officer, I want to compare vendor quotes in different units (price per kg vs per lb) | $pricePerKg = $quote->pricePerUnit()->convertTo('kg'); |  |  |  |
